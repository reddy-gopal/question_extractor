## Project Overview

This project takes raw JEE-style HTML (or text exported from a site), extracts each question with its options and solution, normalizes the math to LaTeX/KaTeX‑friendly form, saves it to a structured JSON file, and optionally uploads that JSON into a Google Sheet for further analysis or export.

The typical flow is:

1. Prepare/update your input HTML/text file.
2. Run `example.py` to parse and convert it into `output.json`.
3. Run `upload_script.py` to push the questions from `output.json` into a Google Sheet.

---

## Files in This Repository

- **`example.py`**  
  - Parses the large JEE HTML/text file (e.g. `input.txt` / `JEE Advanced 2025.txt`) using BeautifulSoup.  
  - Splits it into individual questions, extracts:
    - subject
    - question number
    - question type (`MCQ`, `Radio`, `Numerical`, etc.)
    - question HTML (including images and LaTeX)
    - options A–D
    - correct answer
    - solution HTML  
  - Cleans and converts math expressions into LaTeX/KaTeX‑friendly format.  
  - Writes a list of question objects to `output.json` with a schema like:
    - `subject`
    - `question_no`
    - `question_type`
    - `question` (HTML)
    - `options` (dict with keys `"A"`, `"B"`, `"C"`, `"D"`)
    - `correct_answer`
    - `solution` (HTML)

- **`output.json`**  
  - Generated by `example.py`.  
  - Contains one JSON object per question, following the schema above.  
  - This is the source file used by `upload_script.py` for Google Sheets upload.

- **`upload_script.py`**  
  - Reads `output.json`.  
  - Flattens each question into a single row for Google Sheets with columns:
    - `Subject`
    - `Question_No`
    - `Question_Type`
    - `Question_HTML`
    - `Correct_Answer`
    - `Option_A_Text` … `Option_D_Text`
    - `Solution_HTML`  
  - Uses a Google service account (via `credentials.json`) and a Spreadsheet **ID** to upload rows into the specified sheet/tab.

- **`requirement.txt`**  
  - Lists all Python dependencies (BeautifulSoup, pandas, gspread, Google auth libs, etc.).  
  - Use this to install the environment: `pip install -r requirement.txt`.

- **Other data files** (for example):  
  - `input.txt` / `JEE Advanced 2025.txt`: raw exported HTML/content from the exam site.  
  - `returns.json` or similar: intermediate or alternative JSON outputs used for testing.

---

## Setup

### 0. Clone the repository

From a terminal with Git installed:

```bash
git clone <REPO_URL>
cd <project-folder>  # e.g. cd task3
```

1. **Create and activate a virtual environment (optional but recommended)**:

   ```bash
   python -m venv env
   env\Scripts\activate  # on Windows
   ```

2. **Install dependencies**:

   ```bash
   pip install -r requirement.txt
   ```

3. **Prepare Google Sheets credentials**:
   - Create a **service account** in Google Cloud and enable the *Google Sheets API*.  
   - Download the service account key JSON file and save it as `credentials.json` in the project root (`C:\dev\task3`).  
   - In Google Sheets, share the target spreadsheet with the service account email (from `credentials.json`) with **Editor** access.

---

## How to Run

- **Step 1 – Extract questions to JSON**

  ```bash
  python example.py
  ```

  - Reads the configured input HTML/text file.  
  - Extracts each question, options, and solution.  
  - Normalizes math to LaTeX where possible.  
  - Writes the full list of questions to `output.json`.

- **Step 2 – Upload JSON to Google Sheets**

  In `upload_script.py` configure:

  - `JSON_FILE_PATH` – path to the JSON file to upload (default: `output.json`).  
  - `SPREADSHEET_ID` – the ID from your Google Sheets URL (between `/d/` and `/edit`).  
  - `WORKSHEET_TITLE` – the sheet/tab name to write into (e.g. `"Sheet1"` or `"Sheet2"`).

  Then run:

  ```bash
  python upload_script.py
  ```

  This will:

  - Open the target spreadsheet by ID.  
  - Select or create the worksheet with the given title.  
  - Clear any existing content.  
  - Upload headers + all questions as rows.

---

## Notes / Tips

- If Google Sheets upload fails with a **permission error (403)**, make sure the spreadsheet is shared with the **service account email** from `credentials.json`.  
- If you change the shape of the JSON in `example.py`, also update the mapping in `process_data` inside `upload_script.py`.  
- You can safely open and inspect `output.json` to verify that the extracted fields (question text, options, correct answer, solution) look correct before uploading.
